# Boilerplate for Smart Contract Deployment and Verification

## Overview
This repository serves as a boilerplate for deploying and verifying smart contracts using Hardhat and Hardhat Ignition. It includes configurations for different networks, best practices, and step-by-step deployment instructions.

## Prerequisites
- Node.js installed
- Hardhat installed (`npm install --save-dev hardhat`)
- A valid Ethereum wallet
- API keys for Etherscan and JSON-RPC providers (Infura, Alchemy, etc.)

## Setup
1. Clone this repository:
   ```sh
   git clone <repo-url>
   cd <repo-name>
   ```
2. Install dependencies:
   ```sh
   npm install
   ```
3. Configure environment variables:
   ```sh
   cp .env.example .env
   ```
   - Set `ETHERSCAN_API_KEY`, `PRIVATE_KEY`, and any relevant API keys.

## Deploying your contracts
To deploy your contracts, you can use Hardhat Ignition, our declarative deployment system. You can deploy the Lock contract from the sample project by using its accompanying Ignition module. An Ignition module is a TypeScript or JavaScript file that allows you to specify what needs to be deployed.

In the sample project, the Ignition module `LockModule`, which deploys the `Lock` contract, is under the `./ignition/modules` directory and looks like this:

```javascript
const { buildModule } = require("@nomicfoundation/hardhat-ignition/modules");

const JAN_1ST_2030 = 1893456000;
const ONE_GWEI = 1_000_000_000n;

module.exports = buildModule("LockModule", (m) => {
  const unlockTime = m.getParameter("unlockTime", JAN_1ST_2030);
  const lockedAmount = m.getParameter("lockedAmount", ONE_GWEI);

  const lock = m.contract("Lock", [unlockTime], {
    value: lockedAmount,
  });

  return { lock };
});
```

You can deploy in the localhost network following these steps:

1. Start a local node:
   ```sh
   npx hardhat node
   ```
2. Open a new terminal and deploy the Hardhat Ignition module in the localhost network:
   ```sh
   npx hardhat ignition deploy ./ignition/modules/Lock.js --network localhost
   ```

As a general rule, you can target any network from your Hardhat config using:
   ```sh
   npx hardhat ignition deploy ./ignition/modules/Lock.js --network <your-network>
   ```

If no network is specified, Hardhat Ignition will run against an in-memory instance of Hardhat Network.

For more details, refer to the [Hardhat Ignition documentation](https://hardhat.org/ignition).

## Verifying your contracts
Once your contract is ready, the next step is to deploy it to a live network and verify its source code.

Verifying a contract means making its source code public, along with the compiler settings you used, which allows anyone to compile it and compare the generated bytecode with the one that is deployed on-chain.

### Getting an API key from Etherscan
1. Go to [Etherscan](https://etherscan.io), sign in or create an account.
2. Open the "API Keys" tab and click "Add".
3. Store the API key as `ETHERSCAN_API_KEY`:
   ```sh
   npx hardhat vars set ETHERSCAN_API_KEY
   ```

### Deploying and verifying a contract in the Sepolia testnet
To deploy on Sepolia, ensure your Hardhat config is updated:

```javascript
const { vars } = require("hardhat/config");
const ETHERSCAN_API_KEY = vars.get("ETHERSCAN_API_KEY");
const SEPOLIA_PRIVATE_KEY = vars.get("SEPOLIA_PRIVATE_KEY");

module.exports = {
  networks: {
    sepolia: {
      url: `https://eth-sepolia.g.alchemy.com/v2/${ALCHEMY_API_KEY}`,
      accounts: [SEPOLIA_PRIVATE_KEY],
    },
  },
  etherscan: {
    apiKey: {
      sepolia: ETHERSCAN_API_KEY,
    },
  },
};
```

To deploy:
   ```sh
   npx hardhat ignition deploy ignition/modules/Lock.js --network sepolia --verify
   ```

For additional resources, visit the [Hardhat documentation](https://hardhat.org/).

## Adding support for other networks
If the chain you are using is not in the list, you can manually add the necessary information to verify your contracts on it. For this, you need three things: the chain ID of the network, the URL of the verification endpoint, and the URL of the explorer.

For example, if Goerli wasn't supported, you could add it like this:

```javascript
etherscan: {
  apiKey: {
    goerli: "<goerli-api-key>"
  },
  customChains: [
    {
      network: "goerli",
      chainId: 5,
      urls: {
        apiURL: "https://api-goerli.etherscan.io/api",
        browserURL: "https://goerli.etherscan.io"
      }
    }
  ]
}
```

Keep in mind that the name you are giving to the network in `customChains` is the same one that has to be used in the `apiKey` object.

To see which custom chains are supported, run:
   ```sh
   npx hardhat verify --list-networks
   ```

## License
This project is licensed under the MIT License - see the LICENSE file for details.

---
_Last Updated: 02/01/2025_

